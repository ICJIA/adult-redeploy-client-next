<!DOCTYPE html>
<html class="no-js" lang="">
  <head>
    <meta charset="utf-8" />
    <title></title>
    <meta name="description" content="" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <link rel="manifest" href="site.webmanifest" />
    <link rel="apple-touch-icon" href="icon.png" />
    <!-- Place favicon.ico in the root directory -->

    <meta name="theme-color" content="#fafafa" />
    <script
      src="https://code.jquery.com/jquery-3.4.1.min.js"
      integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
      crossorigin="anonymous"
    ></script>
    <link
      rel="stylesheet"
      type="text/css"
      href="https://cdn.datatables.net/1.10.19/css/jquery.dataTables.css"
    />

    <script
      type="text/javascript"
      charset="utf8"
      src="https://cdn.datatables.net/1.10.19/js/jquery.dataTables.js"
    ></script>
    <link
      rel="stylesheet"
      type="text/css"
      href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.7.5/css/bulma.min.css"
    />
    <style></style>
  </head>

  <body>
    <!--[if IE]>
      <p class="browserupgrade">
        You are using an <strong>outdated</strong> browser. Please
        <a href="https://browsehappy.com/">upgrade your browser</a> to improve
        your experience and security.
      </p>
    <![endif]-->
    <nav class="navbar" role="navigation" aria-label="main navigation">
      <div class="navbar-brand">
        <a class="navbar-item" href="/">
          <img src="/icjia-logo.png" />&nbsp;&nbsp;<span
            style="font-weight: 900"
            >ADULT REDEPLOY ILLINOIS | STATUS</span
          >
        </a>
      </div>
    </nav>
    <section class="section">
      <div class="container">
        <div id="loader" class="has-text-centered">
          <div>LOADING...</div>
        </div>

        <table id="example" class="display" style="width:100%">
          <thead>
            <tr>
              <th>Name</th>
              <th>Provider</th>
              <th>ProviderURL</th>
              <th>Options</th>
              <th>Status</th>
            </tr>
          </thead>
        </table>
      </div>
    </section>
    <script>
      $("#example").hide();
      var api;
      if (
        location.hostname === "localhost" ||
        location.hostname === "127.0.0.1"
      ) {
        api = "http://localhost:9000";
      } else {
        api = "https://ari-dev.netlify.com";
      }
      (function displayStatus(api) {
        let url = api + "/.netlify/functions/status";

        $.getJSON(url, {
          format: "json"
        }).done(function(data) {
          $(document).ready(function() {
            var table = $("#example").DataTable({
              data: data,
              paging: false,
              searching: false,
              responsive: true,
              columns: [
                { data: "name" },
                {
                  data: null,
                  render: function(data, type, row) {
                    return (
                      "<a href='" +
                      data.providerURL +
                      "'>" +
                      data.provider +
                      "</a>"
                    );
                  }
                },
                { data: "providerURL", visible: false },
                { data: "options", visible: false },
                {
                  data: null,
                  render: function(data, type, row) {
                    if (data.status === 200 || data.status === 204) {
                      return (
                        "<span style='background: green; color: white; padding: 5px;'>" +
                        data.status +
                        "</span>"
                      );
                    } else {
                      return (
                        "<span style='background: red; color: white; padding: 5px;'>" +
                        data.status +
                        "</span>"
                      );
                    }
                  }
                }
              ]
            });

            $("#loader").hide();
            $("#example").show();
          });
        });
      })(api);
    </script>
  </body>
</html>
